!function(e){var t={};function n(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(l,o,function(t){return e[t]}.bind(null,o));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=12)}({12:function(e,t,n){e.exports=n(13)},13:function(e,t){!function(e){function t(e){e=$.extend({modal:null,container:null,input:null,button:null,multiple:!1,max:0,values:[],lang:{exceed_max_item:Dcat.lang.exceed_max_item||"已超出最大可选择的数量"}},e);var t=this,n=e.values;for(var l in t.options=e,t.$modal=$(e.modal),t.$input=$(e.input),t.$button=$(e.button),t.labels={},n)t.labels[n[l].id]=n[l].label;return t.resetSelected(),t.$button.on("click",(function(){var e=t.getSelectedRows();t.setKeys(e[1]),t.render(e[0]),t.$modal.modal("toggle")})),t._bind(),t.render(n),t}t.prototype={_bind:function(){var e=this,t=e.options;e.$modal.find(".table-card").on("table:loaded",(function(){var n=e.getCheckbox();t.multiple||$(this).find(".checkbox-grid-header").remove(),e.resetSelected(),n.on("change",(function(){var l=$(this).data("id"),o=$(this).data("label");if(this.checked){if(t.multiple||(e.selected={}),e.selected[l]={id:l,label:o},t.max&&e.getSelectedRows()[0].length>t.max)return $(this).prop("checked",!1),delete e.selected[l],Dcat.warning(e.options.lang.exceed_max_item)}else delete e.selected[l];t.multiple||this.checked&&n.each((function(){$(this).data("id")!=l&&($(this).prop("checked",!1),$(this).parents("tr").css("background-color",""))}))})),n.each((function(){var t=$(this),n=t.data("id");for(var l in e.labels[n]=t.data("label"),e.selected)n!=l||t.prop("checked",!0).trigger("change");t.trigger("change")}))}))},resetSelected:function(){var e=this.getKeys();for(var t in this.selected=[],e)this.selected[e[t]]={id:e[t],label:this.labels[e[t]]}},getCheckbox:function(){return this.$modal.find('.checkbox-grid-column input[type="checkbox"]')},getSelectedRows:function(){var e=[],t=[];for(var n in this.selected)this.selected[n]&&(t.push(n),e.push(this.selected[n]));return[e,t]},render:function(e){var t=this.options,n=$(t.container),l=n.find(".default-text"),o=n.find(".option");return e&&e.length?(l.addClass("d-none"),o.removeClass("d-none"),t.multiple?function(e,t,n){var l=[],o=$(n.container),i=o.find(".default-text"),a=o.find(".option");o.hasClass("select2")||o.addClass("select2 select2-container select2-container--default select2-container--below");for(var r in o.removeClass("form-control"),e)l.push('<li class="select2-selection__choice" >\n    '.concat(e[r].label,' <span data-id="').concat(e[r].id,'" class="select2-selection__choice__remove remove " role="presentation"> ×</span>\n</li>'));l.unshift('<span class="select2-selection__clear remove-all">×</span>'),l='<span class="select2-selection select2-selection--multiple">\n <ul class="select2-selection__rendered">'.concat(l.join(""),"</ul>\n </span>");var s=$(l);function c(){a.html(""),i.removeClass("d-none"),a.addClass("d-none"),o.addClass("form-control"),t.setKeys([])}a.html(s),s.find(".remove").on("click",(function(){var e=$(this);t.deleteKey(e.data("id")),e.parent().remove(),t.getKeys().length||c()})),s.find(".remove-all").on("click",c)}(e,this,t):function(e,t,n){var l=$(n.container),o=l.find(".default-text"),i=l.find(".option"),a=$("<div class='pull-right ' style='font-weight:bold;cursor:pointer'>×</div>");i.text(e[0].label),i.append(a),a.on("click",(function(){t.setKeys([]),o.removeClass("d-none"),i.addClass("d-none")}))}(e,this,t)):(l.removeClass("d-none"),o.addClass("d-none"),void(t.multiple&&n.addClass("form-control")))},setKeys:function(e){this.$input.val(e.length?e.join(","):"")},deleteKey:function(e){var t=this.getKeys(),n=[];for(var l in t)t[l]!=e&&n.push(t[l]);this.setKeys(n)},getKeys:function(){var e=this.$input.val();return e?String(e).split(","):[]}},Dcat.grid.SelectTable=function(e){return new t(e)}}(window)}});
//# sourceMappingURL=select-table.js.map